name: "dart_mass_assignment"
description: "Detect potential mass assignment vulnerabilities in Dart code"
severity: "medium"
patterns:
  - type: "contains"
    pattern: "fromJson("
  - type: "contains"
    pattern: "toJson("
  - type: "regex"
    pattern: "(fromJson|toJson)\\s*\\(\\s*[^)]*\\$\\{.*\\}"
  - type: "contains"
    pattern: "Map<String, dynamic>"
  - type: "contains"
    pattern: ".fromMap("
  - type: "contains"
    pattern: ".toMap("
  - type: "regex"
    pattern: "\\.\\.addAll\\s*\\("
  - type: "contains"
    pattern: "json.decode("
  - type: "regex"
    pattern: "json\\.decode\\s*\\([^)]*\\$\\{.*\\}"
  - type: "contains"
    pattern: "copyWith("
  - type: "regex"
    pattern: "copyWith\\s*\\(\\s*[^)]*\\$\\{.*\\}"
file_types: ["dart"]
fix_suggestion: "Implement explicit field validation and use allowlists for acceptable fields. Avoid direct assignment from user input to model objects without validation."