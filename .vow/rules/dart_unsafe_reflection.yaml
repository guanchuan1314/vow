name: "dart_unsafe_reflection"
description: "Detect potentially unsafe reflection usage in Dart code"
severity: "high"
patterns:
  - type: "contains"
    pattern: "dart:mirrors"
  - type: "contains"
    pattern: "reflect("
  - type: "contains"
    pattern: "MirrorSystem"
  - type: "contains"
    pattern: "InstanceMirror"
  - type: "contains"
    pattern: "ClassMirror"
  - type: "regex"
    pattern: "reflect\\s*\\([^)]*\\$\\{.*\\}"
  - type: "contains"
    pattern: "invoke("
  - type: "regex"
    pattern: "invoke\\s*\\(\\s*Symbol\\s*\\([^)]*\\$\\{.*\\}"
  - type: "contains"
    pattern: "Symbol("
  - type: "regex"
    pattern: "Symbol\\s*\\([^)]*\\$\\{.*\\}"
  - type: "contains"
    pattern: "getField("
  - type: "contains"
    pattern: "setField("
file_types: ["dart"]
fix_suggestion: "Avoid using reflection with user-controlled input. Use code generation or explicit method calls instead. If reflection is necessary, validate all inputs against allowlists."