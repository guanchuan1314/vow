name: "dart_buffer_overflow"
description: "Detect potential buffer overflow vulnerabilities in Dart code"
severity: "high"
patterns:
  - type: "contains"
    pattern: "Uint8List("
  - type: "contains"
    pattern: "ByteBuffer"
  - type: "contains"
    pattern: "dart:ffi"
  - type: "contains"
    pattern: "Pointer<"
  - type: "contains"
    pattern: "malloc("
  - type: "contains"
    pattern: "allocate("
  - type: "regex"
    pattern: "(malloc|allocate)\\s*\\([^)]*\\$\\{.*\\}"
  - type: "contains"
    pattern: ".asTypedList("
  - type: "contains"
    pattern: "ffi.Pointer"
  - type: "contains"
    pattern: "NativeFunction"
  - type: "regex"
    pattern: "Uint8List\\s*\\([^)]*\\$\\{.*\\}"
  - type: "contains"
    pattern: "buffer.lengthInBytes"
file_types: ["dart"]
fix_suggestion: "Validate buffer sizes and bounds before allocation. Use Dart's built-in memory management and avoid unsafe FFI operations with unvalidated sizes."