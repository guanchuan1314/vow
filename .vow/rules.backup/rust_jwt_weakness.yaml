name: "rust_jwt_weakness"
description: "Detect JWT implementation weaknesses in Rust applications"
severity: "high"
patterns:
  - type: "contains"
    pattern: "Algorithm::none"
  - type: "contains"
    pattern: "Algorithm::HS256"
  - type: "regex"
    pattern: "jsonwebtoken::decode\\([^,]*,[^,]*,\\s*&Validation::default\\(\\)"
  - type: "contains"
    pattern: "SECRET_KEY"
  - type: "contains"
    pattern: "jwt_secret"
  - type: "regex"
    pattern: "let\\s+secret\\s*=\\s*\"[^\"]*\""
  - type: "regex"
    pattern: "Validation\\s*\\{[^{}]*verify_exp:\\s*false"
  - type: "regex"
    pattern: "Validation\\s*\\{[^{}]*verify_aud:\\s*false"
  - type: "contains"
    pattern: "verify_signature: false"
  - type: "regex"
    pattern: "decode\\([^)]*\\)(?!.*verify)"
  - type: "contains"
    pattern: "// TODO: use strong secret"
  - type: "contains"
    pattern: "// FIXME: weak JWT"
  - type: "regex"
    pattern: "env::var\\([^)]*JWT[^)]*\\)\\.unwrap_or\\([^)]*\"[^\"]*\""
file_types: ["rs"]