# Vow Security Rules
# These rules detect potential security issues and AI hallucinations

- id: dangerous-eval
  name: Dangerous eval() Usage  
  description: Detects potentially dangerous eval() function calls
  severity: high
  file_types:
    - py
    - js
  patterns:
    - pattern_type: contains
      value: "eval("
      message: "Use of eval() detected - this can lead to code injection vulnerabilities"

- id: system-calls
  name: System Command Execution
  description: Detects system command execution that may be unsafe
  severity: medium
  file_types:
    - py
  patterns:
    - pattern_type: contains
      value: "subprocess.call"
      message: "System call detected - ensure input is properly sanitized"
    - pattern_type: contains
      value: "os.system"
      message: "Direct system call detected - consider safer alternatives"

- id: hardcoded-secrets
  name: Hardcoded Secrets
  description: Detects potential hardcoded API keys or secrets
  severity: high
  file_types:
    - py
    - js
    - ts
    - yaml
    - json
  patterns:
    - pattern_type: contains
      value: "API_KEY"
      message: "Potential hardcoded API key detected"
    - pattern_type: contains
      value: "SECRET_KEY"
      message: "Potential hardcoded secret key detected"
    - pattern_type: contains
      value: "password ="
      message: "Potential hardcoded password detected"

- id: ai-markers
  name: AI Content Markers
  description: Detects content that appears to be AI-generated
  severity: low
  patterns:
    - pattern_type: contains
      value: "As an AI"
      message: "AI-generated content marker detected"
    - pattern_type: contains
      value: "I don't have access"
      message: "AI limitation statement detected"
    - pattern_type: contains
      value: "I cannot"
      message: "AI refusal pattern detected"

- id: placeholder-content
  name: Placeholder Content
  description: Detects incomplete or placeholder content
  severity: low
  patterns:
    - pattern_type: contains
      value: "TODO"
      message: "TODO marker found - content may be incomplete"
    - pattern_type: contains
      value: "FIXME"
      message: "FIXME marker found - known issue exists"
    - pattern_type: contains
      value: "PLACEHOLDER"
      message: "Placeholder text detected"

- id: sql-injection
  name: SQL Injection Risk
  description: Detects potential SQL injection vulnerabilities
  severity: high
  file_types:
    - py
    - js
    - php
  patterns:
    - pattern_type: contains
      value: "SELECT * FROM"
      message: "Raw SQL query detected - use parameterized queries"
    - pattern_type: contains
      value: "INSERT INTO"
      message: "Raw SQL insert detected - ensure proper sanitization"