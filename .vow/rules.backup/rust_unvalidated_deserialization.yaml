name: "rust_unvalidated_deserialization"
description: "Detect unvalidated deserialization vulnerabilities in Rust code"
severity: "high"
patterns:
  - type: "regex"
    pattern: "serde_json::from_str\\s*\\([^)]*user_input"
  - type: "regex"
    pattern: "serde_json::from_slice\\s*\\([^)]*user_input"
  - type: "regex"
    pattern: "bincode::deserialize\\s*\\([^)]*user_input"
  - type: "regex"
    pattern: "ron::from_str\\s*\\([^)]*user_input"
  - type: "regex"
    pattern: "toml::from_str\\s*\\([^)]*user_input"
  - type: "regex"
    pattern: "serde_yaml::from_str\\s*\\([^)]*user_input"
  - type: "contains"
    pattern: "deserialize_with ="
  - type: "regex"
    pattern: "\\.deserialize\\s*\\([^)]*request"
  - type: "regex"
    pattern: "Deserialize::deserialize\\s*\\([^)]*untrusted"
  - type: "contains"
    pattern: "serde(deserialize_with"
file_types: ["rs"]