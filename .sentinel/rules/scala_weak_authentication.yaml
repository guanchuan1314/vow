name: "scala_weak_authentication"
description: "Detect weak authentication mechanisms in Scala/Play applications"
severity: "high"
patterns:
  - type: "contains"
    pattern: "password == \"admin\""
  - type: "contains"
    pattern: "password == \"password\""
  - type: "contains"
    pattern: "password == \"123456\""
  - type: "contains"
    pattern: "def authenticate(username: String, password: String)"
  - type: "contains"
    pattern: "session(\"user\") = "
  - type: "contains"
    pattern: "request.session.get(\"user\")"
  - type: "contains"
    pattern: "withSession(\"user\" -> "
  - type: "contains"
    pattern: "BCrypt.checkpw("
  - type: "contains"
    pattern: "MessageDigest.getInstance(\"MD5\")"
  - type: "contains"
    pattern: "\"Basic \" + "
  - type: "contains"
    pattern: "Base64.encodeBase64("
  - type: "contains"
    pattern: "def login(request: Request"
  - type: "contains"
    pattern: "def signin(request: Request"
  - type: "contains"
    pattern: "JWT.encode("
file_types: ["scala"]