name: "rust_side_channel_attacks"
description: "Detect potential side channel attack vulnerabilities in Rust code"
severity: "medium"
patterns:
  - type: "regex"
    pattern: "String::eq\\([^)]*password[^)]*\\)"
  - type: "regex"
    pattern: "\\&str::eq\\([^)]*secret[^)]*\\)"
  - type: "regex"
    pattern: "Vec::eq\\([^)]*key[^)]*\\)"
  - type: "regex"
    pattern: "[^\\s]+\\s*==\\s*password"
  - type: "regex"
    pattern: "[^\\s]+\\s*==\\s*secret"
  - type: "regex"
    pattern: "[^\\s]+\\s*==\\s*token"
  - type: "regex"
    pattern: "if\\s+[^{]*\\.(password|secret|token)\\s*=="
  - type: "regex"
    pattern: "memcmp\\([^)]*password[^)]*\\)"
  - type: "regex"
    pattern: "constant_time_eq\\([^)]*\\)"
  - type: "regex"
    pattern: "crypto::[^:]*::[^:]*\\([^)]*\\)"
file_types: ["rs"]