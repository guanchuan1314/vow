name: "rust_insecure_randomness"
description: "Detect insecure randomness generation in Rust code"
severity: "medium"
patterns:
  - type: "regex"
    pattern: "use\\s+std::ptr::read_volatile"
  - type: "regex"
    pattern: "rand::thread_rng\\(\\)\\s*\\.gen_range\\([^)]*\\)"
  - type: "regex" 
    pattern: "fastrand::"
  - type: "contains"
    pattern: "std::ptr::read_volatile"
  - type: "contains"
    pattern: "unsafe { *(0x"
  - type: "regex"
    pattern: "SystemTime::now\\(\\)\\s*\\.duration_since"
  - type: "contains"
    pattern: "time::precise_time_ns()"
  - type: "regex"
    pattern: "rand::random::<[^>]*>\\(\\)"
file_types: ["rs"]