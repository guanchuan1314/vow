name: "dart_insecure_storage"
description: "Detect insecure storage practices in Dart/Flutter, particularly storing passwords in SharedPreferences"
severity: "high"
patterns:
  - type: "regex"
    pattern: "SharedPreferences.*\\.setString\\(['\"].*password.*['\"]"
  - type: "regex"
    pattern: "SharedPreferences.*\\.setString\\(['\"].*secret.*['\"]"
  - type: "regex"
    pattern: "SharedPreferences.*\\.setString\\(['\"].*token.*['\"]"
  - type: "regex"
    pattern: "SharedPreferences.*\\.setString\\(['\"].*key.*['\"]"
  - type: "contains"
    pattern: "prefs.setString('password'"
  - type: "contains"
    pattern: "prefs.setString(\"password\""
  - type: "contains"
    pattern: "prefs.setString('secret'"
  - type: "contains"
    pattern: "prefs.setString(\"secret\""
  - type: "contains"
    pattern: "SharedPreferences.setString('auth"
  - type: "contains"
    pattern: "SharedPreferences.setString(\"auth"
  - type: "contains"
    pattern: ".setString('user_password'"
  - type: "contains"
    pattern: ".setString(\"user_password\""
file_types: ["dart"]
fix_suggestion: "Use secure storage solutions like flutter_secure_storage for sensitive data. SharedPreferences stores data in plain text. Never store passwords, tokens, or secrets in SharedPreferences."