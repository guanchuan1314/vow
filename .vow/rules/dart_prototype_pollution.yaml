name: "dart_prototype_pollution"
description: "Detect potential prototype pollution vulnerabilities in Dart code"
severity: "medium"
patterns:
  - type: "contains"
    pattern: "__proto__"
  - type: "contains"
    pattern: "prototype"
  - type: "contains"
    pattern: "constructor"
  - type: "regex"
    pattern: "(\\[|\\.)(__proto__|prototype|constructor)(\\]|\\.|\\[)"
  - type: "contains"
    pattern: "dynamic object"
  - type: "contains"
    pattern: "Map<String, dynamic>"
  - type: "regex"
    pattern: "\\$\\{.*\\}.*(__proto__|prototype|constructor)"
  - type: "contains"
    pattern: "Object.setPrototypeOf("
  - type: "contains"
    pattern: "js_util.setProperty("
  - type: "contains"
    pattern: "dart:js_util"
  - type: "regex"
    pattern: "setProperty\\s*\\([^,)]*,\\s*[\"'](__proto__|prototype|constructor)[\"']"
file_types: ["dart"]
fix_suggestion: "Avoid modifying object prototypes. Use Maps or classes with defined interfaces. Validate property names against allowlists and avoid dynamic property assignment from user input."