name: "rust_rate_limiting"
description: "Detect lack of rate limiting in Rust/Actix web applications"
severity: "high"
patterns:
  - type: "regex"
    pattern: "#[actix_web::"
  - type: "regex"
    pattern: "#\\[(post|put|delete)\\([^)]*\\)]\\s*async\\s+fn\\s+[^{]*\\{[^{}]*(?!.*rate|.*limit|.*throttle)"
  - type: "regex"
    pattern: "async\\s+fn\\s+(login|register|authenticate)[^{]*\\{[^{}]*(?!.*rate|.*limit|.*throttle)"
  - type: "regex"
    pattern: "web::resource\\([^)]*api[^)]*\\)[^.]*\\.route\\([^)]*\\)(?!.*rate|.*limit|.*throttle)"
  - type: "regex"
    pattern: "HttpServer::new\\([^{]*\\{[^{}]*(?!.*rate|.*limit|.*throttle)"
  - type: "contains"
    pattern: "// TODO: add rate limiting"
  - type: "contains"
    pattern: "// FIXME: missing rate limit"
  - type: "regex"
    pattern: "async\\s+fn\\s+upload[^{]*\\{[^{}]*(?!.*rate|.*limit|.*throttle)"
file_types: ["rs"]