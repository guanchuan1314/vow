name: "rust_format_string"
description: "Detect potential format string vulnerabilities in Rust code"
severity: "high"
patterns:
  - type: "regex"
    pattern: "format!\\([^)]*user[^)]*\\)"
  - type: "regex"
    pattern: "println!\\([^)]*user[^)]*\\)"
  - type: "regex"
    pattern: "print!\\([^)]*user[^)]*\\)"
  - type: "regex"
    pattern: "eprintln!\\([^)]*user[^)]*\\)"
  - type: "regex"
    pattern: "eprint!\\([^)]*user[^)]*\\)"
  - type: "regex"
    pattern: "format!\\([^)]*params\\.[^)]*\\)"
  - type: "regex"
    pattern: "println!\\([^)]*params\\.[^)]*\\)"
  - type: "regex"
    pattern: "write!\\([^)]*user[^)]*\\)"
  - type: "regex"
    pattern: "writeln!\\([^)]*user[^)]*\\)"
file_types: ["rs"]