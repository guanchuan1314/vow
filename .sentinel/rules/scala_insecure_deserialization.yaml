name: "scala_insecure_deserialization"
description: "Detect potential insecure deserialization vulnerabilities in Scala code"
severity: "high"
patterns:
  - type: "contains"
    pattern: "ObjectInputStream("
  - type: "contains"
    pattern: ".readObject()"
  - type: "contains"
    pattern: "Json.parse("
  - type: "contains"
    pattern: "Json.fromJson("
  - type: "contains"
    pattern: "upickle.read"
  - type: "contains"
    pattern: "circe.parser.decode"
  - type: "contains"
    pattern: "spray.json.JsonParser"
  - type: "contains"
    pattern: "play.api.libs.json.Json.parse"
  - type: "contains"
    pattern: "scala.util.parsing.json"
  - type: "contains"
    pattern: "org.json4s.jackson.JsonMethods.parse"
  - type: "contains"
    pattern: "Serialization.read"
  - type: "contains"
    pattern: "ObjectMapper.readValue"
  - type: "contains"
    pattern: "Pickle.loads"
file_types: ["scala"]