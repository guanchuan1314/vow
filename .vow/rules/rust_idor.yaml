name: "rust_idor"
description: "Detect potential Insecure Direct Object Reference vulnerabilities in Rust/Actix"
severity: "high"
patterns:
  - type: "regex"
    pattern: "Path<[^>]*id[^>]*>"
  - type: "regex"
    pattern: "web::Path<\\([^)]*id[^)]*\\)>"
  - type: "regex"
    pattern: "params\\.id"
  - type: "regex"
    pattern: "path\\.id"
  - type: "regex"
    pattern: "SELECT\\s+\\*\\s+FROM\\s+\\w+\\s+WHERE\\s+id\\s*=\\s*\\$1"
  - type: "regex"
    pattern: "find\\([^)]*params\\.id[^)]*\\)"
  - type: "regex"
    pattern: "get\\([^)]*path\\.id[^)]*\\)"
  - type: "regex"
    pattern: "WHERE\\s+user_id\\s*=\\s*[^\\s]+"
file_types: ["rs"]