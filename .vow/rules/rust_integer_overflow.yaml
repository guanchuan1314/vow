name: "rust_integer_overflow"
description: "Detect potential integer overflow vulnerabilities in Rust code"
severity: "medium"
patterns:
  - type: "regex"
    pattern: "wrapping_add\\([^)]*\\)"
  - type: "regex"
    pattern: "wrapping_sub\\([^)]*\\)"
  - type: "regex"
    pattern: "wrapping_mul\\([^)]*\\)"
  - type: "regex"
    pattern: "unchecked_add\\([^)]*\\)"
  - type: "regex"
    pattern: "unchecked_sub\\([^)]*\\)"
  - type: "regex"
    pattern: "unchecked_mul\\([^)]*\\)"
  - type: "regex"
    pattern: "as\\s+(u8|u16|u32|u64|i8|i16|i32|i64|usize|isize)"
  - type: "regex"
    pattern: "[^\\s]+\\s*\\+\\s*user_input"
  - type: "regex"
    pattern: "user_input\\s*\\*\\s*[^\\s]+"
  - type: "regex"
    pattern: "params\\.[^\\s]*\\s*[+\\-\\*\\/]\\s*[^\\s]+"
file_types: ["rs"]