name: "scala_insecure_file_permissions"
description: "Detect insecure file permissions in Scala file operations"
severity: "medium"
patterns:
  - type: "contains"
    pattern: "Files.setPosixFilePermissions("
  - type: "contains"
    pattern: "PosixFilePermissions.fromString(\"777"
  - type: "contains"
    pattern: "PosixFilePermissions.fromString(\"666"
  - type: "contains"
    pattern: "PosixFilePermissions.fromString(\"755"
  - type: "contains"
    pattern: "File.setReadable(true, false)"
  - type: "contains"
    pattern: "File.setWritable(true, false)"
  - type: "contains"
    pattern: "File.setExecutable(true, false)"
  - type: "contains"
    pattern: "Files.createTempFile("
  - type: "contains"
    pattern: "Files.createTempDirectory("
  - type: "contains"
    pattern: "new FileWriter("
  - type: "contains"
    pattern: "new FileOutputStream("
  - type: "contains"
    pattern: "PrintWriter("
  - type: "contains"
    pattern: "Files.write("
  - type: "contains"
    pattern: "umask("
file_types: ["scala"]