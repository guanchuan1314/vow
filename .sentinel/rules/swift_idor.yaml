name: "swift_idor"
description: "Detect potential IDOR vulnerabilities in Swift/Vapor applications"
severity: "high"
patterns:
  - type: "contains"
    pattern: "find(\\(.*)).*where.*id"
  - type: "contains"
    pattern: "filter.*id.*req.parameters"
  - type: "contains"
    pattern: "query.*id.*\\(userInput)"
  - type: "contains"
    pattern: ".find(req.parameters.get("
  - type: "contains"
    pattern: "User.find(\\(.*)"
  - type: "contains"
    pattern: "Model.find.*\\(.*)"
  - type: "contains"
    pattern: "database.*where.*id.*\\(.*)"
file_types: ["swift"]