name: "rust_insecure_dependency"
description: "Detect insecure or outdated dependencies in Rust projects"
severity: "medium"
patterns:
  - type: "regex"
    pattern: "serde\\s*=\\s*\"[0-1]\\.[0-9]*\""
  - type: "regex"
    pattern: "actix-web\\s*=\\s*\"[0-3]\\.[0-9]*\""
  - type: "regex"
    pattern: "tokio\\s*=\\s*\"[0-1]\\.[0-9]*\""
  - type: "regex"
    pattern: "reqwest\\s*=\\s*\"[0-10]\\.[0-9]*\""
  - type: "contains"
    pattern: "git = \"http://"
  - type: "regex"
    pattern: "path\\s*=\\s*\"\\.\\./"
  - type: "contains"
    pattern: "# TODO: update dependency"
  - type: "contains"
    pattern: "# FIXME: vulnerable version"
  - type: "regex"
    pattern: "openssl\\s*=\\s*\"[0-1]\\.[0-9]*\""
  - type: "regex"
    pattern: "uuid\\s*=\\s*\"[0-7]\\.[0-9]*\""
  - type: "regex"
    pattern: "rand\\s*=\\s*\"[0-7]\\.[0-9]*\""
  - type: "regex"
    pattern: "regex\\s*=\\s*\"[0-1]\\.[0-9]*\""
file_types: ["rs", "toml"]