name: "rust_improper_error_handling"
description: "Detect improper error handling patterns in Rust/Actix code"
severity: "medium"
patterns:
  - type: "regex"
    pattern: "\\.unwrap\\(\\)"
  - type: "regex"
    pattern: "\\.expect\\([^)]*\\)"
  - type: "regex"
    pattern: "panic!\\([^)]*\\)"
  - type: "regex"
    pattern: "\\.unwrap_or_else\\(\\|_\\|\\s*panic!"
  - type: "regex"
    pattern: "match\\s+[^{]*\\{[^}]*_\\s*=>\\s*\\{\\s*\\}"
  - type: "regex"
    pattern: "catch_unwind\\([^)]*\\)\\s*\\.is_err\\(\\)"
  - type: "contains"
    pattern: "Error: {}"
  - type: "regex"
    pattern: "HttpResponse::InternalServerError\\(\\)\\s*\\.body\\([^)]*error[^)]*\\)"
  - type: "contains"
    pattern: ".map_err(|_| ())"
  - type: "regex"
    pattern: "Result<[^,]*,\\s*\\(\\)>"
file_types: ["rs"]