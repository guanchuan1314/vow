name: "rust_concurrency_issues"
description: "Detect potential concurrency issues in Rust code"
severity: "medium"
patterns:
  - type: "regex"
    pattern: "tokio::spawn\\([^)]*\\)[^;]*;[^;]*unsafe"
  - type: "regex"
    pattern: "async\\s+fn[^{]*\\{[^}]*unsafe[^}]*\\}"
  - type: "regex"
    pattern: "std::thread::spawn\\([^)]*\\)[^;]*;[^;]*unsafe"
  - type: "regex"
    pattern: "Arc<[^>]*>[^;]*;[^;]*clone\\(\\)[^;]*;[^;]*unsafe"
  - type: "regex"
    pattern: "Mutex::lock\\(\\)[^;]*;[^;]*unsafe"
  - type: "regex"
    pattern: "RwLock::write\\(\\)[^;]*;[^;]*unsafe"
  - type: "regex"
    pattern: "RwLock::read\\(\\)[^;]*;[^;]*unsafe"
  - type: "regex"
    pattern: "crossbeam::thread::spawn\\([^)]*\\)"
file_types: ["rs"]