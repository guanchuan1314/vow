name: "scala_unsafe_reflection"
description: "Detect potential unsafe reflection vulnerabilities in Scala code"
severity: "high"
patterns:
  - type: "contains"
    pattern: "Class.forName("
  - type: "contains"
    pattern: ".getClass.getMethod("
  - type: "contains"
    pattern: ".getDeclaredMethod("
  - type: "contains"
    pattern: ".newInstance()"
  - type: "contains"
    pattern: "Constructor.newInstance("
  - type: "contains"
    pattern: ".setAccessible(true)"
  - type: "contains"
    pattern: "Method.invoke("
  - type: "contains"
    pattern: "Field.set("
  - type: "contains"
    pattern: "Field.get("
  - type: "contains"
    pattern: "scala.reflect.runtime"
  - type: "contains"
    pattern: "scala.reflect.api"
  - type: "contains"
    pattern: "TypeTag["
  - type: "contains"
    pattern: "WeakTypeTag["
  - type: "contains"
    pattern: "classOf["
file_types: ["scala"]