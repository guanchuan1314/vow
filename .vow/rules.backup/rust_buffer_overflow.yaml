name: "rust_buffer_overflow"
description: "Detect potential buffer overflow vulnerabilities in unsafe Rust code"
severity: "critical"
patterns:
  - type: "regex"
    pattern: "unsafe\\s*\\{[^}]*\\*[^}]*\\}"
  - type: "regex"
    pattern: "unsafe\\s*\\{[^}]*ptr::[^}]*\\}"
  - type: "regex"
    pattern: "std::ptr::copy\\([^)]*\\)"
  - type: "regex"
    pattern: "std::ptr::copy_nonoverlapping\\([^)]*\\)"
  - type: "regex"
    pattern: "\\*[^\\s]+ = [^;]*;"
  - type: "regex"
    pattern: "slice::from_raw_parts\\([^)]*\\)"
  - type: "regex"
    pattern: "slice::from_raw_parts_mut\\([^)]*\\)"
  - type: "regex"
    pattern: "Vec::from_raw_parts\\([^)]*\\)"
  - type: "contains"
    pattern: "get_unchecked("
  - type: "contains"
    pattern: "get_unchecked_mut("
file_types: ["rs"]