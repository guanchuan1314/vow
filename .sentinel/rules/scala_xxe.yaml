name: "scala_xxe"
description: "Detect potential XXE vulnerabilities in Scala XML parsing"
severity: "high"
patterns:
  - type: "contains"
    pattern: "XML.loadString("
  - type: "contains"
    pattern: "XML.loadFile("
  - type: "contains"
    pattern: "XMLFactory.newInstance()"
  - type: "contains"
    pattern: "DocumentBuilderFactory.newInstance()"
  - type: "contains"
    pattern: "SAXParserFactory.newInstance()"
  - type: "contains"
    pattern: "TransformerFactory.newInstance()"
  - type: "contains"
    pattern: "XMLReader.parse("
  - type: "contains"
    pattern: "scala.xml.XML.load"
  - type: "contains"
    pattern: "scala.xml.parsing"
  - type: "contains"
    pattern: "setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, false)"
  - type: "contains"
    pattern: "setEntityResolver(null)"
  - type: "contains"
    pattern: "<!ENTITY"
file_types: ["scala"]