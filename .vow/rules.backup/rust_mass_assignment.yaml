name: "rust_mass_assignment"
description: "Detect potential mass assignment vulnerabilities in Rust/Actix web handlers"
severity: "medium"
patterns:
  - type: "regex"
    pattern: "serde_json::from_str\\([^)]*\\)"
  - type: "regex"
    pattern: "serde_json::from_value\\([^)]*\\)"
  - type: "regex"
    pattern: "#\\[derive\\([^)]*Deserialize[^)]*\\)]"
  - type: "contains"
    pattern: "Json<UserInput>"
  - type: "contains"
    pattern: "web::Json<"
  - type: "regex"
    pattern: "actix_web::web::Json<[^>]*>"
  - type: "regex"
    pattern: "let\\s+[^:]+:\\s*[^=]+\\s*=\\s*serde_json::from_str\\([^)]*\\)?"
file_types: ["rs"]