name: "rust_eval_injection"
description: "Detect potential eval/code injection vulnerabilities in Rust"
severity: "critical"
patterns:
  - type: "regex"
    pattern: "std::process::Command::new\\([^)]*user[^)]*\\)"
  - type: "regex"
    pattern: "Command::new\\([^)]*params\\.[^)]*\\)"
  - type: "regex"
    pattern: "std::process::Command::new\\(&[^)]*input[^)]*\\)"
  - type: "contains"
    pattern: "Command::new(user_input)"
  - type: "contains"
    pattern: "Command::new(&user_cmd)"
  - type: "regex"
    pattern: "\\.arg\\([^)]*user[^)]*\\)"
  - type: "regex"
    pattern: "\\.args\\(&[^)]*user[^)]*\\)"
file_types: ["rs"]