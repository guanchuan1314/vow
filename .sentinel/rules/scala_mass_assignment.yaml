name: "scala_mass_assignment"
description: "Detect potential mass assignment vulnerabilities in Scala/Play code"
severity: "medium"
patterns:
  - type: "contains"
    pattern: "Json.fromJson[User]("
  - type: "contains"
    pattern: "Json.fromJson[Account]("
  - type: "contains"
    pattern: "Form.bindFromRequest()"
  - type: "contains"
    pattern: ".bindFromRequest().get"
  - type: "contains"
    pattern: "request.body.asJson"
  - type: "contains"
    pattern: "Json.toJson(request.body)"
  - type: "contains"
    pattern: "case class.*@(.*)Json.reads"
  - type: "contains"
    pattern: ".as[User]"
  - type: "contains"
    pattern: ".as[Account]"
  - type: "contains"
    pattern: ".as[Admin]"
  - type: "contains"
    pattern: "implicit val.*Reads"
  - type: "contains"
    pattern: "Json.obj() ++"
  - type: "contains"
    pattern: "request.body.validate"
file_types: ["scala"]