name: "scala_race_condition"
description: "Detect potential race condition vulnerabilities in Scala concurrent code"
severity: "medium"
patterns:
  - type: "contains"
    pattern: "var.*mutable"
  - type: "contains"
    pattern: "mutable.Map"
  - type: "contains"
    pattern: "mutable.Set"
  - type: "contains"
    pattern: "mutable.Buffer"
  - type: "contains"
    pattern: "AtomicReference"
  - type: "contains"
    pattern: "AtomicInteger"
  - type: "contains"
    pattern: "AtomicBoolean"
  - type: "contains"
    pattern: "Future {"
  - type: "contains"
    pattern: "parallel.ParIterable"
  - type: "contains"
    pattern: "Actor {"
  - type: "contains"
    pattern: "akka.actor"
  - type: "contains"
    pattern: "synchronized {"
  - type: "contains"
    pattern: "wait()"
  - type: "contains"
    pattern: "notify()"
file_types: ["scala"]