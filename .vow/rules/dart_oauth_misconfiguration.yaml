name: "dart_oauth_misconfiguration" 
description: "Detect OAuth misconfiguration vulnerabilities in Dart code"
severity: "high"
patterns:
  - type: "contains"
    pattern: "Bearer token"
  - type: "regex"
    pattern: "Authorization['\"]?\\s*[:=]\\s*['\"]Bearer\\s+[A-Za-z0-9\\-\\._~\\+\\/]+=*['\"]"
  - type: "contains"
    pattern: "\"Bearer ey"
  - type: "contains"
    pattern: "'Bearer ey"
  - type: "contains"
    pattern: "oauth_token = \""
  - type: "contains"
    pattern: "access_token = \""
  - type: "contains"
    pattern: "client_secret = \""
  - type: "contains"
    pattern: "refresh_token = \""
  - type: "regex"
    pattern: "(client_secret|access_token|refresh_token)\\s*[:=]\\s*['\"][^'\"]{20,}['\"]"
  - type: "contains"
    pattern: "http://localhost"
  - type: "contains"
    pattern: "redirect_uri: \"http://"
file_types: ["dart"]
fix_suggestion: "Store OAuth tokens securely using secure storage mechanisms. Use HTTPS for redirect URIs, implement proper token refresh logic, and never hardcode client secrets."