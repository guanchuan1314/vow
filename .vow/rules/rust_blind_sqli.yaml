name: "rust_blind_sqli"
description: "Detect potential blind SQL injection patterns in Rust applications"
severity: "critical"
patterns:
  - type: "regex"
    pattern: "format!\\([^,]*SELECT[^,]*,[^)]*\\)"
  - type: "regex"
    pattern: "format!\\([^,]*INSERT[^,]*,[^)]*\\)"
  - type: "regex"
    pattern: "format!\\([^,]*UPDATE[^,]*,[^)]*\\)"
  - type: "regex"
    pattern: "format!\\([^,]*DELETE[^,]*,[^)]*\\)"
  - type: "regex"
    pattern: "format!\\([^,]*WHERE[^,]*,[^)]*\\)"
  - type: "regex"
    pattern: "\"{0}\"[^.]*format[^)]*\\)"
  - type: "regex"
    pattern: "execute\\([^&]*&format!"
  - type: "regex"
    pattern: "query\\([^&]*&format!"
  - type: "regex"
    pattern: "sqlx::[^(]*\\([^&]*&format!"
  - type: "contains"
    pattern: "ORDER BY {}"
  - type: "contains"
    pattern: "LIMIT {}"
  - type: "regex"
    pattern: "\\+\\s*&[^;]*user_input"
  - type: "contains"
    pattern: "// TODO: use prepared statements"
  - type: "contains"
    pattern: "// FIXME: SQL injection"
file_types: ["rs"]