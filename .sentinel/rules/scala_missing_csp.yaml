name: "scala_missing_csp"
description: "Detect missing Content Security Policy headers in Scala/Play applications"
severity: "medium"
patterns:
  - type: "contains"
    pattern: "Ok(views.html"
  - type: "contains"
    pattern: "Action {"
  - type: "contains"
    pattern: "Action.async {"
  - type: "contains"
    pattern: "def index"
  - type: "contains"
    pattern: "def show"
  - type: "contains"
    pattern: "def create"
  - type: "contains"
    pattern: "def edit"
  - type: "contains"
    pattern: "Result("
  - type: "contains"
    pattern: "Ok("
  - type: "contains"
    pattern: "BadRequest("
  - type: "contains"
    pattern: "NotFound("
  - type: "contains"
    pattern: "InternalServerError("
  - type: "contains"
    pattern: "play.api.mvc.Controller"
  - type: "contains"
    pattern: "extends Controller"
file_types: ["scala"]