name: "dart_xml_injection"
description: "Detect potential XML injection vulnerabilities in Dart code"
severity: "high"
patterns:
  - type: "contains"
    pattern: "XmlDocument.parse("
  - type: "contains"
    pattern: "XmlElement("
  - type: "regex"
    pattern: "(XmlDocument\\.parse|XmlElement)\\s*\\(\\s*[\"'].*\\$\\{.*\\}.*[\"']"
  - type: "contains"
    pattern: "\"<tag>${"
  - type: "contains"
    pattern: "\"></${"
  - type: "contains"
    pattern: "setAttribute(\"${" 
  - type: "contains"
    pattern: "xml.parse("
  - type: "contains"
    pattern: "parseXmlDocument("
file_types: ["dart"]
fix_suggestion: "Validate and sanitize user input before incorporating into XML. Use XML libraries that properly escape special characters or use DOM manipulation methods."