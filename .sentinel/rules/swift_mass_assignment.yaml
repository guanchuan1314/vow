name: "swift_mass_assignment"
description: "Detect potential mass assignment vulnerabilities in Swift/Vapor"
severity: "high"
patterns:
  - type: "contains"
    pattern: "req.content.decode("
  - type: "contains"
    pattern: ".decode(.*, from: req"
  - type: "contains"
    pattern: "JSONDecoder.*decode.*req"
  - type: "contains"
    pattern: "Content.*decode.*Model"
  - type: "contains"
    pattern: "decode.*sensitive"
  - type: "contains"
    pattern: "decode.*admin"
  - type: "contains"
    pattern: "decode.*isAdmin"
file_types: ["swift"]