name: "rust_leaky_error_handling"
description: "Detect error handling that leaks sensitive information in Rust/Actix web applications"
severity: "medium"
patterns:
  - type: "regex"
    pattern: "HttpResponse::InternalServerError\\(\\)[^.]*\\.body\\(format!\\([^)]*error[^)]*\\)"
  - type: "regex"
    pattern: "HttpResponse::BadRequest\\(\\)[^.]*\\.json\\([^)]*error[^)]*\\)"
  - type: "regex"
    pattern: "\\.map_err\\(\\|e\\|[^)]*format!\\([^)]*\\{\\}[^)]*,\\s*e\\)"
  - type: "regex"
    pattern: "Error:\\s*\\{\\}[^\"]*\"[^\"]*database"
  - type: "regex"
    pattern: "Error:\\s*\\{\\}[^\"]*\"[^\"]*connection"
  - type: "regex"
    pattern: "Error:\\s*\\{\\}[^\"]*\"[^\"]*password"
  - type: "regex"
    pattern: "\\.unwrap_or_else\\(\\|e\\|[^)]*e\\.to_string"
  - type: "regex"
    pattern: "println!\\([^)]*[\"'][^\"']*error[^\"']*[\"'][^)]*\\)"
  - type: "contains"
    pattern: "DatabaseError: {}"
  - type: "contains"
    pattern: "AuthError: {}"
  - type: "regex"
    pattern: "HttpResponse::InternalServerError\\(\\)[^.]*\\.body\\([^)]*\\{[^}]*error[^}]*\\}"
file_types: ["rs"]