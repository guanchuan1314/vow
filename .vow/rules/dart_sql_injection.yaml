name: "dart_sql_injection"
description: "Detect potential SQL injection vulnerabilities in Dart code"
severity: "high"
patterns:
  - type: "contains"
    pattern: "rawQuery("
  - type: "contains"
    pattern: "query("
  - type: "regex"
    pattern: "(rawQuery|query)\\s*\\(\\s*[\"'].*\\$\\{.*\\}.*[\"']"
  - type: "contains"
    pattern: "\"SELECT * FROM ${"
  - type: "contains" 
    pattern: "\"INSERT INTO ${"
  - type: "contains"
    pattern: "\"UPDATE ${"
  - type: "contains"
    pattern: "\"DELETE FROM ${"
  - type: "contains"
    pattern: "execute(\"SELECT"
  - type: "contains"
    pattern: "execute(\"INSERT"
  - type: "contains"
    pattern: "execute(\"UPDATE"
  - type: "contains"
    pattern: "execute(\"DELETE"
file_types: ["dart"]
fix_suggestion: "Use parameterized queries or prepared statements instead of string interpolation. Use query parameters with ? placeholders and pass values separately."