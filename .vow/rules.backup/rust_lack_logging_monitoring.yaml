name: "rust_lack_logging_monitoring"
description: "Detect lack of proper logging and monitoring in Rust/Actix web applications"
severity: "medium"
patterns:
  - type: "regex"
    pattern: "#[actix_web::"
  - type: "regex"
    pattern: "#\\[(post|put|delete)\\([^)]*\\)]\\s*async\\s+fn\\s+[^{]*\\{[^{}]*(?!.*log::)"
  - type: "regex"
    pattern: "async\\s+fn\\s+login[^{]*\\{[^{}]*(?!.*log::)"
  - type: "regex"
    pattern: "async\\s+fn\\s+authenticate[^{]*\\{[^{}]*(?!.*log::)"
  - type: "regex"
    pattern: "HttpResponse::Unauthorized\\(\\)[^;]*(?!.*log::)"
  - type: "regex"
    pattern: "HttpResponse::Forbidden\\(\\)[^;]*(?!.*log::)"
  - type: "regex"
    pattern: "\\.map_err\\(\\|_\\|[^)]*\\)(?!.*log::)"
  - type: "contains"
    pattern: "// TODO: add logging"
  - type: "contains"
    pattern: "// FIXME: missing logs"
file_types: ["rs"]