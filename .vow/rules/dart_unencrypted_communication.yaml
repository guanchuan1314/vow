name: "dart_unencrypted_communication"
description: "Detect unencrypted HTTP communication in Dart/Flutter instead of HTTPS"
severity: "medium"
patterns:
  - type: "regex"
    pattern: "['\"]http://[^'\"]*['\"]"
  - type: "contains"
    pattern: "baseUrl: 'http://"
  - type: "contains"
    pattern: "baseUrl: \"http://"
  - type: "contains"
    pattern: "endpoint: 'http://"
  - type: "contains"
    pattern: "endpoint: \"http://"
  - type: "contains"
    pattern: "url: 'http://"
  - type: "contains"
    pattern: "url: \"http://"
  - type: "regex"
    pattern: "Uri\\.parse\\(['\"]http://[^'\"]*['\"]\\)"
  - type: "contains"
    pattern: "http.get('http://"
  - type: "contains"
    pattern: "http.post('http://"
  - type: "contains"
    pattern: "http.put('http://"
  - type: "contains"
    pattern: "http.delete('http://"
  - type: "contains"
    pattern: "dio.get('http://"
  - type: "contains"
    pattern: "dio.post('http://"
  - type: "regex"
    pattern: "allowBadCertificates:\\s*true"
file_types: ["dart"]
fix_suggestion: "Use HTTPS URLs instead of HTTP for all network communications. Ensure certificate validation is enabled and avoid allowing bad certificates in production."