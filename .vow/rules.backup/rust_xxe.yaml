name: "rust_xxe"
description: "Detect potential XXE vulnerabilities in Rust XML parsing"
severity: "high"
patterns:
  - type: "regex"
    pattern: "quick_xml::Reader::from_str\\([^)]*\\)"
  - type: "regex"
    pattern: "roxmltree::Document::parse\\([^)]*\\)"
  - type: "regex"
    pattern: "xml::reader::XmlReader::new\\([^)]*\\)"
  - type: "contains"
    pattern: "serde_xml_rs::from_str"
  - type: "contains"
    pattern: "Parser::new().parse"
  - type: "regex"
    pattern: "EventReader::new\\([^)]*\\)"
  - type: "regex"
    pattern: "ParserConfig::new\\(\\)\\s*\\.create_reader\\([^)]*\\)"
file_types: ["rs"]