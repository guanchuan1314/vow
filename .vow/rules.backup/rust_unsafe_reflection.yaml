name: "rust_unsafe_reflection"
description: "Detect unsafe reflection patterns in Rust code"
severity: "high"
patterns:
  - type: "regex"
    pattern: "std::mem::transmute\\s*\\("
  - type: "regex"
    pattern: "std::mem::transmute_copy\\s*\\("
  - type: "regex"
    pattern: "unsafe\\s*\\{[^}]*transmute"
  - type: "contains"
    pattern: "std::any::TypeId"
  - type: "contains"
    pattern: "std::any::Any"
  - type: "regex"
    pattern: "\\*mut\\s+dyn\\s+Any"
  - type: "regex"
    pattern: "\\*const\\s+dyn\\s+Any"
  - type: "contains"
    pattern: "downcast_ref::<"
  - type: "contains"
    pattern: "downcast_mut::<"
  - type: "regex"
    pattern: "mem::forget\\s*\\("
file_types: ["rs"]