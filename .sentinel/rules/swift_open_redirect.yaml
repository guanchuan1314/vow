name: "swift_open_redirect"
description: "Detect potential open redirect/unvalidated redirect vulnerabilities in Swift/Vapor"
severity: "high"
patterns:
  - type: "contains"
    pattern: "req.redirect(to: \\(.*)"
  - type: "contains"
    pattern: "redirect(to: \"\\(.*)\""
  - type: "contains"
    pattern: "Response.redirect(to: \\(.*)"
  - type: "contains"
    pattern: "Location.*\\(.*)"
  - type: "contains"
    pattern: "redirect.*userInput"
  - type: "contains"
    pattern: "redirect.*req.query"
  - type: "contains"
    pattern: "redirect.*req.content"
file_types: ["swift"]