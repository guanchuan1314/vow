name: "rust_csrf"
description: "Detect potential CSRF vulnerabilities in Rust/Actix web endpoints"
severity: "high"
patterns:
  - type: "regex"
    pattern: "#\\[actix_web::post\\([^)]*\\)]"
  - type: "regex"
    pattern: "#\\[actix_web::put\\([^)]*\\)]"
  - type: "regex"
    pattern: "#\\[actix_web::delete\\([^)]*\\)]"
  - type: "regex"
    pattern: "#\\[post\\([^)]*\\)]"
  - type: "regex"
    pattern: "#\\[put\\([^)]*\\)]"
  - type: "regex"
    pattern: "#\\[delete\\([^)]*\\)]"
  - type: "regex"
    pattern: "web::(post|put|delete)\\([^)]*\\)"
  - type: "regex"
    pattern: "Route::new\\(\\)\\.(post|put|delete)\\([^)]*\\)"
file_types: ["rs"]