name: "dart_command_injection"
description: "Detect potential command injection vulnerabilities in Dart code"
severity: "high"
patterns:
  - type: "contains"
    pattern: "Process.run("
  - type: "contains"
    pattern: "Process.start("
  - type: "contains"
    pattern: "Process.runSync("
  - type: "regex"
    pattern: "Process\\.(run|start|runSync)\\s*\\(\\s*[\"'].*\\$\\{.*\\}.*[\"']"
  - type: "contains"
    pattern: "shell: true"
  - type: "contains"
    pattern: "ProcessResult("
  - type: "contains"
    pattern: "exec("
  - type: "contains"
    pattern: "system("
  - type: "contains"
    pattern: "\"cmd /c ${" 
  - type: "contains"
    pattern: "\"/bin/sh -c ${" 
file_types: ["dart"]
fix_suggestion: "Avoid executing user input directly as commands. Use process arguments arrays instead of shell commands, validate and sanitize all inputs, or use allowlists for permitted commands."