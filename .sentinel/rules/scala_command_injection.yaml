name: "scala_command_injection"
description: "Detect potential command injection vulnerabilities in Scala code"
severity: "high"
patterns:
  - type: "contains"
    pattern: "Process(s\""
  - type: "contains"
    pattern: "Process(\".*\" + "
  - type: "contains"
    pattern: "Runtime.getRuntime.exec("
  - type: "contains"
    pattern: "ProcessBuilder("
  - type: "contains"
    pattern: "s\"sh -c $"
  - type: "contains"
    pattern: "s\"bash -c $"
  - type: "contains"
    pattern: "s\"cmd /c $"
  - type: "contains"
    pattern: "s\"powershell $"
  - type: "contains"
    pattern: '"sh" :: "-c" :: '
  - type: "contains"
    pattern: 'Seq("sh", "-c",'
  - type: "contains"
    pattern: "sys.process"
  - type: "contains"
    pattern: "import scala.sys.process"
file_types: ["scala"]