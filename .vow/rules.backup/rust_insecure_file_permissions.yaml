name: "rust_insecure_file_permissions"
description: "Detect insecure file permission patterns in Rust code"
severity: "medium"
patterns:
  - type: "regex"
    pattern: "fs::set_permissions\\([^,]*,\\s*Permissions::from_mode\\(0o777\\)"
  - type: "regex"
    pattern: "fs::set_permissions\\([^,]*,\\s*Permissions::from_mode\\(0o666\\)"
  - type: "regex"
    pattern: "OpenOptions::new\\(\\)[^.]*\\.mode\\(0o777\\)"
  - type: "regex"
    pattern: "OpenOptions::new\\(\\)[^.]*\\.mode\\(0o666\\)"
  - type: "regex"
    pattern: "File::create\\([^)]*\\)[^.]*\\.set_permissions\\([^)]*0o777"
  - type: "regex"
    pattern: "std::fs::create_dir_all\\([^)]*\\)[^.]*\\.set_permissions\\([^)]*0o777"
  - type: "contains"
    pattern: "umask(0)"
  - type: "regex"
    pattern: "\\.permissions\\(\\)[^.]*\\.mode\\(\\)\\s*[|&]\\s*0o777"
  - type: "regex"
    pattern: "DirBuilder::new\\(\\)[^.]*\\.mode\\(0o777\\)"
  - type: "contains"
    pattern: "chmod 777"
file_types: ["rs"]