name: "dart_ssrf"
description: "Detect potential SSRF vulnerabilities in Dart applications"
severity: "high"
patterns:
  - type: "contains"
    pattern: "http.get("
  - type: "contains"
    pattern: "http.post("
  - type: "contains"
    pattern: "HttpClient()"
  - type: "regex"
    pattern: "(http\\.(get|post|put|delete)|HttpClient)\\s*\\([^)]*\\$\\{.*\\}"
  - type: "contains"
    pattern: "Uri.parse("
  - type: "regex"
    pattern: "Uri\\.parse\\s*\\(\\s*[\"'].*\\$\\{.*\\}.*[\"']"
  - type: "contains"
    pattern: "\"http://${" 
  - type: "contains"
    pattern: "\"https://${" 
  - type: "contains"
    pattern: "dio.get("
  - type: "contains"
    pattern: "dio.post("
  - type: "contains"
    pattern: "client.get("
  - type: "contains"
    pattern: "fetch("
file_types: ["dart"]
fix_suggestion: "Validate URLs against an allowlist of permitted domains/IPs. Avoid using user input directly in HTTP requests. Use URL parsing and validation to prevent access to internal resources."