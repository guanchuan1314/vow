name: "rust_insecure_cryptography"
description: "Detect insecure cryptography practices in Rust code"
severity: "high"
patterns:
  - type: "contains"
    pattern: "use md5::"
  - type: "contains"
    pattern: "use sha1::"
  - type: "regex"
    pattern: "Md5::digest\\("
  - type: "regex"
    pattern: "Sha1::digest\\("
  - type: "contains"
    pattern: "crypto::md5::"
  - type: "contains"
    pattern: "crypto::sha1::"
  - type: "regex"
    pattern: "rand::random::<\\[u8;\\s*16\\]>\\(\\)"
  - type: "contains"
    pattern: "DES::"
  - type: "contains"
    pattern: "RC4::"
  - type: "regex"
    pattern: "use\\s+openssl::symm::Cipher::(des|rc4)"
  - type: "contains"
    pattern: "ECB"
  - type: "regex"
    pattern: "key\\s*=\\s*[\"'][^\"']{1,7}[\"']"
  - type: "regex"
    pattern: "password\\s*=\\s*[\"'][^\"']{1,7}[\"']"
  - type: "contains"
    pattern: "pbkdf2::pbkdf2_simple(\"password\""
file_types: ["rs"]