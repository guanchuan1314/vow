name: "dart_input_validation"
description: "Detect insufficient input validation in Dart/Flutter form inputs"
severity: "medium"
patterns:
  - type: "contains"
    pattern: "TextFormField("
  - type: "contains"
    pattern: "validator: null"
  - type: "contains"
    pattern: "autovalidate: false"
  - type: "contains"
    pattern: "autovalidateMode: AutovalidateMode.disabled"
  - type: "regex"
    pattern: "TextFormField\\([^)]*\\)(?!.*validator:)"
  - type: "regex"
    pattern: "TextField\\([^)]*\\)(?!.*validator:)"
  - type: "contains"
    pattern: "return null;"
  - type: "regex"
    pattern: "validator:\\s*\\(.*\\)\\s*=>\\s*null"
  - type: "regex"
    pattern: "validator:\\s*\\(.*\\)\\s*\\{[^}]*return null;[^}]*\\}"
  - type: "contains"
    pattern: "// TODO: Add validation"
  - type: "contains"
    pattern: "// No validation needed"
file_types: ["dart"]
fix_suggestion: "Add proper input validation using validator functions. Check for empty fields, validate formats (email, phone), sanitize inputs, and provide meaningful error messages."