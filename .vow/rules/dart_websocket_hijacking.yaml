name: "dart_websocket_hijacking"
description: "Detect potential WebSocket hijacking vulnerabilities in Dart code"
severity: "high"
patterns:
  - type: "contains"
    pattern: "WebSocket.connect("
  - type: "contains"
    pattern: "IOWebSocketChannel.connect("
  - type: "regex"
    pattern: "WebSocket\\.connect\\s*\\([^)]*\\$\\{.*\\}"
  - type: "regex"
    pattern: "IOWebSocketChannel\\.connect\\s*\\([^)]*\\$\\{.*\\}"
  - type: "contains"
    pattern: "ws://"
  - type: "contains"
    pattern: "\"ws://${" 
  - type: "contains"
    pattern: "\"wss://${" 
  - type: "contains"
    pattern: "allowSelfSigned: true"
  - type: "contains"
    pattern: "badCertificateCallback:"
  - type: "contains"
    pattern: "headers: {"
  - type: "regex"
    pattern: "headers:\\s*\\{[^}]*\\$\\{.*\\}"
  - type: "contains"
    pattern: "Origin:"
  - type: "contains"
    pattern: "validateOrigin: false"
file_types: ["dart"]
fix_suggestion: "Validate WebSocket origins, use secure WebSocket connections (WSS), implement proper authentication, and validate all incoming messages. Avoid user-controlled WebSocket URLs."