name: "scala_use_after_free"
description: "Detect potential use after free vulnerabilities in Scala code"
severity: "high"
patterns:
  - type: "contains"
    pattern: ".close()"
  - type: "contains"
    pattern: ".dispose()"
  - type: "contains"
    pattern: ".shutdown()"
  - type: "contains"
    pattern: "DirectByteBuffer"
  - type: "contains"
    pattern: "sun.misc.Unsafe"
  - type: "contains"
    pattern: "java.nio.DirectByteBuffer"
  - type: "contains"
    pattern: "Cleaner.clean()"
  - type: "contains"
    pattern: "PhantomReference"
  - type: "contains"
    pattern: "WeakReference"
  - type: "contains"
    pattern: "finalize()"
  - type: "contains"
    pattern: "System.gc()"
  - type: "contains"
    pattern: "Runtime.gc()"
  - type: "contains"
    pattern: "try.*finally.*close"
file_types: ["scala"]