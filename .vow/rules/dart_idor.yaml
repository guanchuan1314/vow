name: "dart_idor"
description: "Detect potential Insecure Direct Object Reference vulnerabilities in Dart code"
severity: "high"
patterns:
  - type: "regex"
    pattern: "(get|post|put|delete)\\s*\\([^)]*['\"][^'\"]*\\$\\{.*\\}[^'\"]*['\"]"
  - type: "contains"
    pattern: "/user/${" 
  - type: "contains"
    pattern: "/account/${" 
  - type: "contains"
    pattern: "/profile/${" 
  - type: "contains"
    pattern: "/document/${" 
  - type: "contains"
    pattern: "/file/${" 
  - type: "contains"
    pattern: "/api/user/${" 
  - type: "contains"
    pattern: "userId = "
  - type: "contains"
    pattern: "accountId = "
  - type: "contains"
    pattern: "fileId = "
  - type: "regex"
    pattern: "(userId|accountId|fileId|documentId)\\s*=\\s*[^;]*\\$\\{.*\\}"
  - type: "contains"
    pattern: "findById("
file_types: ["dart"]
fix_suggestion: "Implement proper authorization checks before accessing resources. Verify that the user has permission to access the requested object using access control lists or ownership validation."