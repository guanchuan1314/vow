name: "scala_csrf"
description: "Detect missing CSRF protection in Scala/Play state-changing endpoints"
severity: "medium"
patterns:
  - type: "contains"
    pattern: "def delete"
  - type: "contains"
    pattern: "def update"
  - type: "contains"
    pattern: "def create"
  - type: "contains"
    pattern: "def post"
  - type: "contains"
    pattern: "def put"
  - type: "contains"
    pattern: "Action.async"
  - type: "contains"
    pattern: "Action {"
  - type: "contains"
    pattern: "POST("
  - type: "contains"
    pattern: "PUT("
  - type: "contains"
    pattern: "DELETE("
  - type: "contains"
    pattern: "transferMoney"
  - type: "contains"
    pattern: "changePassword"
  - type: "contains"
    pattern: "updateProfile"
  - type: "contains"
    pattern: "deleteAccount"
file_types: ["scala"]