name: "dart_graphql_injection"
description: "Detect potential GraphQL injection vulnerabilities in Dart code"
severity: "high"
patterns:
  - type: "contains"
    pattern: "GraphQLClient("
  - type: "contains"
    pattern: "mutate("
  - type: "contains"
    pattern: "query("
  - type: "regex"
    pattern: "(query|mutation).*\\$\\{.*\\}"
  - type: "contains"
    pattern: "\"query { ${" 
  - type: "contains"
    pattern: "\"mutation { ${" 
  - type: "contains"
    pattern: "gql(\"${" 
  - type: "contains"
    pattern: "GraphQLRequest(\"${" 
  - type: "contains"
    pattern: "query: \"${" 
  - type: "contains"
    pattern: "operationName: \"${" 
file_types: ["dart"]
fix_suggestion: "Use parameterized GraphQL queries with variables instead of string interpolation. Validate and sanitize all user inputs before using them in GraphQL operations."