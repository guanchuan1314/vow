name: "rust_uninitialized_memory"
description: "Detect potential uninitialized memory usage in unsafe Rust code"
severity: "critical"
patterns:
  - type: "regex"
    pattern: "MaybeUninit::<[^>]*>::uninit\\(\\)"
  - type: "regex"
    pattern: "mem::uninitialized\\(\\)"
  - type: "regex"
    pattern: "mem::zeroed\\(\\)"
  - type: "regex"
    pattern: "MaybeUninit::uninit\\(\\)"
  - type: "regex"
    pattern: "assume_init\\(\\)"
  - type: "regex"
    pattern: "unsafe\\s*\\{[^}]*MaybeUninit[^}]*assume_init[^}]*\\}"
  - type: "regex"
    pattern: "Vec::with_capacity\\([^)]*\\)[^;]*;[^;]*unsafe[^;]*set_len"
  - type: "regex"
    pattern: "Vec::<[^>]*>::with_capacity\\([^)]*\\)"
  - type: "contains"
    pattern: "mem::transmute("
file_types: ["rs"]