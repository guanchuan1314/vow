name: "rust_template_injection"
description: "Detect potential template injection vulnerabilities in Rust templating engines"
severity: "high"
patterns:
  - type: "regex"
    pattern: "handlebars::Handlebars::new\\(\\)\\s*\\.render_template\\([^)]*user[^)]*\\)"
  - type: "regex"
    pattern: "tera::Tera::render\\([^)]*user[^)]*\\)"
  - type: "regex"
    pattern: "liquid::Template::parse\\([^)]*user[^)]*\\)"
  - type: "contains"
    pattern: ".render_template(user_template"
  - type: "contains"
    pattern: ".render(&user_input"
  - type: "regex"
    pattern: "Template::parse\\([^)]*params\\.[^)]*\\)"
  - type: "regex"
    pattern: "\\.render_template\\(&[^)]*input[^)]*\\)"
file_types: ["rs"]