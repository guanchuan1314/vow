name: "rust_null_pointer_dereference"
description: "Detect potential null pointer dereference patterns in unsafe Rust code"
severity: "critical"
patterns:
  - type: "regex"
    pattern: "unsafe\\s*\\{[^{}]*\\*\\s*ptr[^{}]*\\}"
  - type: "regex"
    pattern: "\\*\\s*std::ptr::null\\(\\)"
  - type: "regex"
    pattern: "\\*\\s*std::ptr::null_mut\\(\\)"
  - type: "regex"
    pattern: "unsafe\\s*\\{[^{}]*\\*[^{}]*as\\s*\\*[^{}]*\\}"
  - type: "contains"
    pattern: "ptr::null()"
  - type: "contains"
    pattern: "ptr::null_mut()"
  - type: "regex"
    pattern: "\\*\\s*\\([^)]*as\\s*\\*[^)]*\\)"
  - type: "regex"
    pattern: "unsafe\\s*\\{[^{}]*\\*[^{}]*0[^{}]*as[^{}]*\\}"
  - type: "contains"
    pattern: "*(0 as *"
  - type: "contains"
    pattern: "// TODO: null check"
  - type: "contains"
    pattern: "// FIXME: null pointer"
  - type: "regex"
    pattern: "std::ptr::[^(]*\\([^)]*\\)(?!.*is_null|.*check)"
file_types: ["rs"]