name: "scala_buffer_overflow"
description: "Detect potential buffer overflow risks in Scala code"
severity: "high"
patterns:
  - type: "contains"
    pattern: "Array.ofDim"
  - type: "contains"
    pattern: "new Array["
  - type: "contains"
    pattern: "ByteBuffer.allocate("
  - type: "contains"
    pattern: "Array.fill("
  - type: "contains"
    pattern: "Array.range("
  - type: "contains"
    pattern: "mutable.Buffer"
  - type: "contains"
    pattern: "ArrayBuffer("
  - type: "contains"
    pattern: ".update(index, "
  - type: "contains"
    pattern: "array(index) = "
  - type: "contains"
    pattern: "System.arraycopy("
  - type: "contains"
    pattern: "Array.copy("
  - type: "contains"
    pattern: "unsafe.putByte("
  - type: "contains"
    pattern: "DirectByteBuffer"
file_types: ["scala"]