name: "rust_insufficient_auth"
description: "Detect insufficient authentication and authorization in Rust/Actix web applications"
severity: "high"
patterns:
  - type: "contains"
    pattern: "#[actix_web::post"
  - type: "contains"
    pattern: "#[actix_web::put"
  - type: "contains"
    pattern: "#[actix_web::delete"
  - type: "contains"
    pattern: "web::resource("
  - type: "contains"
    pattern: "// TODO: add authentication"
  - type: "contains"
    pattern: "// FIXME: missing auth check"
  - type: "contains"
    pattern: "async fn delete_"
  - type: "contains"
    pattern: "async fn admin_"
  - type: "contains"
    pattern: "HttpRequest"
  - type: "contains"
    pattern: ".cookie("
file_types: ["rs"]