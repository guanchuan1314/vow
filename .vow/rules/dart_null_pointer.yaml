name: "dart_null_pointer"
description: "Detect potential null pointer dereferences in Dart code, particularly force-unwrapping nullable values"
severity: "medium"
patterns:
  - type: "regex"
    pattern: "\\w+\\!"
  - type: "regex"
    pattern: "\\w+\\[\\w+\\]\\!"
  - type: "regex"
    pattern: "\\w+\\.\\w+\\!"
  - type: "regex"
    pattern: "\\w+\\(\\)\\!"
  - type: "regex"
    pattern: "\\)\\!"
  - type: "regex"
    pattern: "[^!]\\w+\\s*!(?!\\s*[=<>!])"
  - type: "contains"
    pattern: "as dynamic"
  - type: "contains"
    pattern: "as Object"
  - type: "regex"
    pattern: "as\\s+\\w+(?!\\?)"
  - type: "contains"
    pattern: "// ignore: unnecessary_non_null_assertion"
  - type: "contains"
    pattern: "late final"
  - type: "contains"
    pattern: "late var"
  - type: "contains"
    pattern: "late String"
  - type: "contains"
    pattern: "late int"
  - type: "contains"
    pattern: "late bool"
file_types: ["dart"]
fix_suggestion: "Avoid force-unwrapping nullable values with !. Use null-aware operators (?., ??, ?..[]), null checks, or handle null cases explicitly. Use late keyword carefully and ensure initialization."