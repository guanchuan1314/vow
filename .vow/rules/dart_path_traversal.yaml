name: "dart_path_traversal"
description: "Detect potential path traversal vulnerabilities in Dart code"
severity: "high"
patterns:
  - type: "contains"
    pattern: "File("
  - type: "contains"
    pattern: "Directory("
  - type: "regex"
    pattern: "(File|Directory)\\s*\\(\\s*[\"'].*\\$\\{.*\\}.*[\"']"
  - type: "contains"
    pattern: "\"../${" 
  - type: "contains"
    pattern: "\"../\"" 
  - type: "contains"
    pattern: "readAsString()" 
  - type: "contains"
    pattern: "writeAsString(" 
  - type: "contains"
    pattern: "openRead()" 
  - type: "contains"
    pattern: "path.join("
  - type: "regex"
    pattern: "path\\.join\\s*\\([^,)]*\\$\\{.*\\}"
  - type: "contains"
    pattern: "Platform.pathSeparator"
file_types: ["dart"]
fix_suggestion: "Validate and sanitize file paths. Use path.normalize(), check for directory traversal sequences, and implement allowlists for accessible directories."