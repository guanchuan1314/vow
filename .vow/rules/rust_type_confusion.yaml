name: "rust_type_confusion"
description: "Detect potential type confusion vulnerabilities in unsafe Rust code"
severity: "high"
patterns:
  - type: "regex"
    pattern: "std::mem::transmute\\([^)]*\\)"
  - type: "regex"
    pattern: "unsafe\\s*\\{[^}]*transmute[^}]*\\}"
  - type: "regex"
    pattern: "transmute::<[^,]*,\\s*[^>]*>\\([^)]*\\)"
  - type: "regex"
    pattern: "std::mem::transmute_copy\\([^)]*\\)"
  - type: "regex"
    pattern: "ptr::read\\([^)]*as\\s*\\*const[^)]*\\)"
  - type: "regex"
    pattern: "ptr::write\\([^)]*as\\s*\\*mut[^)]*\\)"
  - type: "regex"
    pattern: "unsafe\\s*\\{[^}]*\\*\\([^)]*as\\s*\\*[^)]*\\)[^}]*\\}"
  - type: "regex"
    pattern: "std::slice::from_raw_parts\\([^)]*as\\s*\\*[^)]*\\)"
  - type: "regex"
    pattern: "union\\s+\\w+\\s*\\{"
file_types: ["rs"]