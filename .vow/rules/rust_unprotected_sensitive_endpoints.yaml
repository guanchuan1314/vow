name: "rust_unprotected_sensitive_endpoints"
description: "Detect unprotected sensitive endpoints in Rust/Actix web applications"
severity: "high"
patterns:
  - type: "regex"
    pattern: "web::resource\\([\"']/admin[^\"']*[\"']\\)[^.]*\\.route\\([^)]*\\)(?!.*middleware::auth|.*guard)"
  - type: "regex"
    pattern: "web::resource\\([\"']/api/admin[^\"']*[\"']\\)[^.]*\\.route\\([^)]*\\)(?!.*middleware::auth|.*guard)"
  - type: "regex"
    pattern: "#\\[actix_web::(get|post|put|delete)\\([\"']/admin[^\"']*[\"']\\)](?![^}]*auth|[^}]*guard)"
  - type: "regex"
    pattern: "#\\[actix_web::(get|post|put|delete)\\([\"']/api/users[^\"']*[\"']\\)](?![^}]*auth)"
  - type: "regex"
    pattern: "#\\[actix_web::(post|put|delete)\\([\"']/api/[^\"']*[\"']\\)]\\s*async\\s+fn\\s+[^(]*\\([^)]*\\)\\s*->\\s*[^{]*\\{(?!.*auth)"
  - type: "regex"
    pattern: "web::resource\\([\"']/config[^\"']*[\"']\\)[^.]*\\.route\\([^)]*\\)(?!.*auth)"
  - type: "regex"
    pattern: "web::resource\\([\"']/debug[^\"']*[\"']\\)[^.]*\\.route\\([^)]*\\)(?!.*auth)"
  - type: "contains"
    pattern: "\"/api/secret\""
  - type: "contains"
    pattern: "\"/internal/\""
  - type: "regex"
    pattern: "#\\[actix_web::get\\([\"']/health[^\"']*[\"']\\)]\\s*async\\s+fn\\s+[^(]*\\([^)]*\\)\\s*->\\s*[^{]*\\{[^}]*database"
file_types: ["rs"]