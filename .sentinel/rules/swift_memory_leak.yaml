name: "swift_memory_leak"
description: "Detect potential memory leaks from strong reference cycles in Swift"
severity: "medium"
patterns:
  - type: "contains"
    pattern: "{ \\[.*\\] in"
  - type: "contains"
    pattern: "self\\."
  - type: "contains"
    pattern: "closure.*self"
  - type: "contains"
    pattern: "retain.*cycle"
  - type: "contains"
    pattern: "strong.*reference.*cycle"
  - type: "contains"
    pattern: "capture.*self"
  - type: "contains"
    pattern: "\\[weak self\\]"
file_types: ["swift"]